"use strict";(globalThis.webpackChunk_croquet_microverse=globalThis.webpackChunk_croquet_microverse||[]).push([[635],{1635:(t,i,n)=>{n.r(i),n.d(i,{default:()=>e});const e={modules:[{name:"Spin",actorBehaviors:[class SpinActor{setup(){this.listen("startSpinning","startSpinning"),this.listen("stopSpinning","stopSpinning"),this.listen("newAngle","newAngle")}startSpinning(t){this.isSpinning=!0,this.qSpin=Worldcore.q_euler(0,t,0),this.doSpin()}doSpin(){this.isSpinning&&(this.setRotation(Worldcore.q_multiply(this._rotation,this.qSpin)),this.future(50).doSpin())}stopSpinning(){this.isSpinning=!1}newAngle(t){this.publish("scope","newAngle",t)}destroy(){delete this.isSpinning,this.unsubscribe(this.id,"startSpinning"),this.unsubscribe(this.id,"stopSpinning"),this.unsubscribe(this.id,"newAngle")}}],pawnBehaviors:[class SpinPawn{setup(){this.addEventListener("pointerDown","onPointerDown"),this.addEventListener("pointerUp","onPointerUp"),this.addEventListener("pointerMove","onPointerMove")}theta(t){var i=this.translation;return(Math.atan2(i[2]-t[2],t[0]-i[0])+2*Math.PI)%(2*Math.PI)}onPointerDown(t){this.base=this.theta(t.xyz),this.baseRotation=[...this._rotation],this.say("stopSpinning"),this.moveBuffer=[]}onPointerMove(t){this.moveBuffer.push(t.xyz),3<this.moveBuffer.length&&this.moveBuffer.shift();let i=(this.theta(t.xyz)-this.base+2*Math.PI)%(2*Math.PI);t=Worldcore.q_euler(0,i,0);this.say("setRotation",Worldcore.q_multiply(this.baseRotation,t)),i=i<Math.PI?i:i-2*Math.PI,this.say("newAngle",i)}onPointerUp(t){var i,n;!t.xyz||this.moveBuffer.length<3||(i=this.theta(this.moveBuffer[0]),n=this.theta(t.xyz),this.onPointerMove(t),this.deltaAngle=(n+2*Math.PI)%(2*Math.PI)-(i+2*Math.PI)%(2*Math.PI),.001<Math.abs(this.deltaAngle)&&(t=this.deltaAngle,t=Math.min(Math.max(-.1,t),.1),this.say("startSpinning",t)))}destroy(){this.removeEventListener("pointerDown","onPointerDown"),this.removeEventListener("pointerUp","onPointerUp"),this.removeEventListener("pointerMove","onPointerMove")}}]}]}}}]);